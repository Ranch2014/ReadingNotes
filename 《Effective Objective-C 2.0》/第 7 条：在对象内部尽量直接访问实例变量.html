<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.3 (452849)"/><meta name="altitude" content="14.18412208557129"/><meta name="author" content="郭嘉"/><meta name="created" content="2016-01-05 11:08:32 +0000"/><meta name="latitude" content="30.22814225331537"/><meta name="longitude" content="120.0331111577298"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2016-01-07 12:37:33 +0000"/><title>第 7 条：在对象内部尽量直接访问实例变量</title></head><body>
<div>
<blockquote style="padding: 10px 15px; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(153, 153, 153); word-break: break-word; font-size: 15px; font-weight: 100; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: whitesmoke;">
<p style="font-size: 15px; font-weight: normal; text-align: justify; word-break: break-word;">强烈建议：读取实例变量时直接访问；设置实例变量时通过属性。</p>
</blockquote>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">示例代码：</p>
<pre style="padding: 9.5px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(101, 123, 131); border-radius: 4px; word-break: break-all; word-wrap: normal; white-space: pre; border: 1px solid rgba(0, 0, 0, 0.14902); overflow: auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(253, 246, 227);">
<code style="padding: 0px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre; background-color: transparent;"><span style="color: rgb(133, 153, 0);">@interface</span> <span style="color: rgb(181, 137, 0);">EOCPerson</span> : <span style="color: rgb(181, 137, 0);">NSObject</span>
<span style="color: rgb(133, 153, 0);">@property</span> (<span style="color: rgb(133, 153, 0);">nonatomic</span>, <span style="color: rgb(133, 153, 0);">copy</span>) <span style="color: rgb(38, 139, 210);">NSString</span> *firstName;
<span style="color: rgb(133, 153, 0);">@property</span> (<span style="color: rgb(133, 153, 0);">nonatomic</span>, <span style="color: rgb(133, 153, 0);">copy</span>) <span style="color: rgb(38, 139, 210);">NSString</span> *lastName;

<span style="color: rgb(147, 161, 161);">// Convenience for firstName + " " + lastName:</span>
- (<span style="color: rgb(38, 139, 210);">NSString</span>*)fullName;
- (<span style="color: rgb(133, 153, 0);">void</span>)setFullName:(<span style="color: rgb(38, 139, 210);">NSString</span>*)fullName;
<span style="color: rgb(133, 153, 0);">@end</span></code>
</pre>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">方法实现（点语法形式）：</p>
<pre style="padding: 9.5px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(101, 123, 131); border-radius: 4px; word-break: break-all; word-wrap: normal; white-space: pre; border: 1px solid rgba(0, 0, 0, 0.14902); overflow: auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(253, 246, 227);">
<code style="padding: 0px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre; background-color: transparent;">- (<span style="color: rgb(38, 139, 210);">NSString</span>*)fullName {
    <span style="color: rgb(133, 153, 0);">return</span> [<span style="color: rgb(38, 139, 210);">NSString</span> stringWithFormat:<span style="color: rgb(42, 161, 152);">@"%@ %@"</span>, <span style="color: rgb(133, 153, 0);">self</span><span style="color: rgb(181, 137, 0);">.firstName</span>, <span style="color: rgb(133, 153, 0);">self</span><span style="color: rgb(181, 137, 0);">.lastName</span>];
}

- (<span style="color: rgb(133, 153, 0);">void</span>)setFullName:(<span style="color: rgb(38, 139, 210);">NSString</span> *)fullName {
    <span style="color: rgb(38, 139, 210);">NSArray</span> *components = [fullName componentsSeparatedByString:<span style="color: rgb(42, 161, 152);">@" "</span>];
    <span style="color: rgb(133, 153, 0);">self</span><span style="color: rgb(181, 137, 0);">.firstName</span> = [components objectAtIndex:<span style="color: rgb(42, 161, 152);">0</span>];
    <span style="color: rgb(133, 153, 0);">self</span><span style="color: rgb(181, 137, 0);">.lastName</span> = [components objectAtIndex:<span style="color: rgb(42, 161, 152);">1</span>];
}</code>
</pre>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">直接访问实例变量形式：</p>
<pre style="padding: 9.5px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(101, 123, 131); border-radius: 4px; word-break: break-all; word-wrap: normal; white-space: pre; border: 1px solid rgba(0, 0, 0, 0.14902); overflow: auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(253, 246, 227);">
<code style="padding: 0px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre; background-color: transparent;">- (<span style="color: rgb(38, 139, 210);">NSString</span>*)fullName {
    <span style="color: rgb(133, 153, 0);">return</span> [<span style="color: rgb(38, 139, 210);">NSString</span> stringWithFormat:<span style="color: rgb(42, 161, 152);">@"%@ %@"</span>, _firstName, _lastName];
}

- (<span style="color: rgb(133, 153, 0);">void</span>)setFullName:(<span style="color: rgb(38, 139, 210);">NSString</span> *)fullName {
    <span style="color: rgb(38, 139, 210);">NSArray</span> *components = [fullName componentsSeparatedByString:<span style="color: rgb(42, 161, 152);">@" "</span>];
    _firstName = [components objectAtIndex:<span style="color: rgb(42, 161, 152);">0</span>];
    _lastName = [components objectAtIndex:<span style="color: rgb(42, 161, 152);">1</span>];
}</code>
</pre>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">区别：</p>
<ol style="padding: 0px; text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">
<li>直接访问实例变量的特点：不经过 OC 的“方法派送”（method dispatch），速度更快；不会调用 <code style="padding: 2px 4px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre-wrap; background-color: rgb(253, 246, 227);">setter</code> 方法，绕过了“内存管理语义”；不会触发“键值观测”（Key-Value Observing, KVO）通知。</li>
<li>属性访问优点：可以给 <code style="padding: 2px 4px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre-wrap; background-color: rgb(253, 246, 227);">getter</code> 和/或 <code style="padding: 2px 4px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre-wrap; background-color: rgb(253, 246, 227);">setter</code> 方法新增断点，便于查错。</li>
</ol>
<blockquote style="padding: 10px 15px; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(153, 153, 153); word-break: break-word; font-size: 15px; font-weight: 100; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: whitesmoke;">
<p style="font-size: 15px; font-weight: normal; text-align: justify; word-break: break-word;">一种合理的折中方案：写入实例变量时，通过“设置方法”；读取实例变量时，直接访问。<br/>
原因：既能提高读取操作的速度，又能控制对属性的写入操作。</p>
</blockquote>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">惰性（延迟）实例化示例代码：</p>
<pre style="padding: 9.5px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(101, 123, 131); border-radius: 4px; word-break: break-all; word-wrap: normal; white-space: pre; border: 1px solid rgba(0, 0, 0, 0.14902); overflow: auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(253, 246, 227);">
<code style="padding: 0px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre; background-color: transparent;">- (<span style="color: rgb(181, 137, 0);">EOCBrain</span>*)brain {
    <span style="color: rgb(133, 153, 0);">if</span> (!_brain) {
        _brain = [<span style="color: rgb(181, 137, 0);">Brain</span> <span style="color: rgb(133, 153, 0);">new</span>];
    }
    <span style="color: rgb(133, 153, 0);">return</span> _brain;
}</code>
</pre>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">一些名词：<br/>
“键值观测”（Key-Value Observing, KVO）通知：一种通知机制，当某对象属性改变时，可通知其他对象。</p>
<div style="padding: 10px 15px; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(153, 153, 153); word-break: break-word; font-size: 15px; font-weight: 100; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: whitesmoke;margin-left:40px;">
<div><br/></div>
<div style="font-size: 15px; font-weight: normal; text-align: justify; word-break: break-word;">
<div>主要来源：<a href="http://book.douban.com/subject/25829244/" target="_blank" style="color: rgb(64, 148, 199); text-decoration: none;">《Effective Objective-C 2.0》</a></div>
</div>
</div>
</div>
</body></html>