<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.3 (452849)"/><meta name="altitude" content="15.17179679870605"/><meta name="author" content="郭嘉"/><meta name="created" content="2016-01-04 02:49:42 +0000"/><meta name="latitude" content="30.22828941809979"/><meta name="longitude" content="120.0331709377029"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2016-01-04 09:00:46 +0000"/><title>第 3 条：多用字面量语法，少用与之等价的方法</title></head><body>
<div>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">使用字面量语法（literal syntax）可以缩减源代码长度，使其更易读。</p>
<ul style="padding: 0px; text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">
<li>字面数值</li>
</ul>
</div>
<div><br/></div>
<div>
<div style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">
<div>有时需要把整数、浮点数、布尔值封入 OC 对象中，这种情况下可以用 NSNumber 类，该类可以处理多种类型的数值。</div>
</div>
<pre style="padding: 9.5px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(101, 123, 131); border-radius: 4px; word-break: break-all; word-wrap: normal; white-space: pre; border: 1px solid rgba(0, 0, 0, 0.14902); overflow: auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(253, 246, 227);">
<code style="padding: 0px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre; background-color: transparent;"><span style="color: rgb(147, 161, 161);">// 不用字面量，创建一个数字</span>
<span style="color: rgb(38, 139, 210);">NSNumber</span> *someNumber = [<span style="color: rgb(38, 139, 210);">NSNumber</span> numberWithInt:<span style="color: rgb(42, 161, 152);">1</span>];

<span style="color: rgb(147, 161, 161);">// 使用字面量</span>
<span style="color: rgb(38, 139, 210);">NSNumber</span> *someNumber = @<span style="color: rgb(42, 161, 152);">1</span>;</code>
</pre>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">NSNumber 实例表示的所有数据类型都可使用该语法，代码：</p>
<pre style="padding: 9.5px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(101, 123, 131); border-radius: 4px; word-break: break-all; word-wrap: normal; white-space: pre; border: 1px solid rgba(0, 0, 0, 0.14902); overflow: auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(253, 246, 227);">
<code style="padding: 0px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre; background-color: transparent;"><span style="color: rgb(38, 139, 210);">NSNumber</span> *intNumber = @<span style="color: rgb(42, 161, 152);">1</span>;
<span style="color: rgb(38, 139, 210);">NSNumber</span> *floatNumber = @<span style="color: rgb(42, 161, 152);">2.5</span>f;
<span style="color: rgb(38, 139, 210);">NSNumber</span> *doubleNumber = @<span style="color: rgb(42, 161, 152);">3.1415</span>;
<span style="color: rgb(38, 139, 210);">NSNumber</span> *boolNumber = @YES;
<span style="color: rgb(38, 139, 210);">NSNumber</span> *charNumber = @<span style="color: rgb(42, 161, 152);">'a'</span>;</code>
</pre>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">字面量表示数值可以令 NSNumber 对象变得整洁（因为声明中只包含数值，而没有多余的成分）。</p>
<ul style="padding: 0px; text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">
<li>字面量数组</li>
</ul>
<pre style="padding: 9.5px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(101, 123, 131); border-radius: 4px; word-break: break-all; word-wrap: normal; white-space: pre; border: 1px solid rgba(0, 0, 0, 0.14902); overflow: auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(253, 246, 227);">
<code style="padding: 0px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre; background-color: transparent;"><span style="color: rgb(147, 161, 161);">// 不使用字面量语法创建数组，取下标操作</span>
<span style="color: rgb(38, 139, 210);">NSArray</span> *animals = [<span style="color: rgb(38, 139, 210);">NSArray</span> arrayWithObjects:<span style="color: rgb(42, 161, 152);">@"cat"</span>, <span style="color: rgb(42, 161, 152);">@"dog"</span>, <span style="color: rgb(42, 161, 152);">@"monkey"</span>, nil];
<span style="color: rgb(38, 139, 210);">NSString</span> *dog = [animals objectAtIndex:<span style="color: rgb(42, 161, 152);">1</span>];
<span style="color: rgb(147, 161, 161);">// "arrayWithObjects:" 方法会依次处理各个参数，直到发现 nil</span>

<span style="color: rgb(147, 161, 161);">// 字面量语法</span>
<span style="color: rgb(38, 139, 210);">NSArray</span> *animals = @[<span style="color: rgb(42, 161, 152);">@"cat"</span>, <span style="color: rgb(42, 161, 152);">@"dog"</span>, <span style="color: rgb(42, 161, 152);">@"monkey"</span>];
<span style="color: rgb(38, 139, 210);">NSString</span> *dog = animals[<span style="color: rgb(42, 161, 152);">1</span>]; <span style="color: rgb(147, 161, 161);">//“取下标”（subscripting）操作</span></code>
</pre>
<blockquote style="padding: 10px 15px; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(153, 153, 153); word-break: break-word; font-size: 15px; font-weight: 100; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: whitesmoke;">
<p style="font-size: 15px; font-weight: normal; text-align: justify; word-break: break-word;">注意：字面量语法创建数组时，若数组元素对象中有 nil，会抛出异常。<br/>
原因：字面量语法实际上只是一种“语法糖”，其效果等于先创建一个数组，然后把方括号内的所有对象都加到这个数组。</p>
</blockquote>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">字面量语法更安全：抛出异常令应用程序终止，比创建好数组后才发现元素个数少了好。向数组中插入 nil 通常说明程序有错。</p>
<ul style="padding: 0px; text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">
<li>字面量字典</li>
</ul>
<pre style="padding: 9.5px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(101, 123, 131); border-radius: 4px; word-break: break-all; word-wrap: normal; white-space: pre; border: 1px solid rgba(0, 0, 0, 0.14902); overflow: auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(253, 246, 227);">
<code style="padding: 0px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre; background-color: transparent;"><span style="color: rgb(147, 161, 161);">// 不使用字面量语法定义的字典，取值操作</span>
<span style="color: rgb(38, 139, 210);">NSDictionary</span> *personData = [<span style="color: rgb(38, 139, 210);">NSDictionary</span> dictionaryWithObjectsAndKeys:
                                <span style="color: rgb(42, 161, 152);">@"Thomas"</span>, <span style="color: rgb(42, 161, 152);">@"firstName"</span>,
                                <span style="color: rgb(42, 161, 152);">@"Jefferson"</span>, <span style="color: rgb(42, 161, 152);">@"lastName"</span>,
                                [<span style="color: rgb(38, 139, 210);">NSNumber</span> numberWithInt:<span style="color: rgb(42, 161, 152);">28</span>], <span style="color: rgb(42, 161, 152);">@"age"</span>,
                                nil];
<span style="color: rgb(38, 139, 210);">NSString</span> *firstName = [personData objectForKey:<span style="color: rgb(42, 161, 152);">@"firstName"</span>];

<span style="color: rgb(147, 161, 161);">// 字面量语法定义</span>
<span style="color: rgb(38, 139, 210);">NSDictionary</span> *personData = @{ <span style="color: rgb(42, 161, 152);">@"firstName"</span> : <span style="color: rgb(42, 161, 152);">@"Thomas"</span>,
                               <span style="color: rgb(42, 161, 152);">@"lastName"</span> : <span style="color: rgb(42, 161, 152);">@"Jefferson"</span>,
                                    <span style="color: rgb(42, 161, 152);">@"age"</span> : @<span style="color: rgb(42, 161, 152);">28</span>
                               };
<span style="color: rgb(38, 139, 210);">NSString</span> *firstName = personData[<span style="color: rgb(42, 161, 152);">@"firstName"</span>];</code>
</pre>
<blockquote style="padding: 10px 15px; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(153, 153, 153); word-break: break-word; font-size: 15px; font-weight: 100; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: whitesmoke;">
<p style="font-size: 15px; font-weight: normal; text-align: justify; word-break: break-word;">注：字典中的对象和键必须都是 OC 对象，不能把整数直接放进去，要封装成 NSNumber 实例。<br/>
字面量定义的字典，若值为 nil，也会抛出异常。</p>
</blockquote>
<ul style="padding: 0px; text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">
<li>可变数组与字典</li>
</ul>
<pre style="padding: 9.5px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(101, 123, 131); border-radius: 4px; word-break: break-all; word-wrap: normal; white-space: pre; border: 1px solid rgba(0, 0, 0, 0.14902); overflow: auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(253, 246, 227);">
<code style="padding: 0px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre; background-color: transparent;">[<span style="color: rgb(133, 153, 0);">mutableArray</span> replaceObjectAtIndex:1 withObject:@<span style="color: rgb(42, 161, 152);">"dog"</span>]<span style="color: rgb(147, 161, 161);">;</span>
[<span style="color: rgb(133, 153, 0);">mutableDictionary</span> setObject:@<span style="color: rgb(42, 161, 152);">"Hello"</span> forKey:@<span style="color: rgb(42, 161, 152);">"lastName"</span>]<span style="color: rgb(147, 161, 161);">;</span>

// 下标操作
mutableArray[<span style="color: rgb(133, 153, 0);">1</span>] = @<span style="color: rgb(42, 161, 152);">"dog"</span><span style="color: rgb(147, 161, 161);">;</span>
mutableDictionary[<span style="color: rgb(133, 153, 0);">@</span><span style="color: rgb(42, 161, 152);">"lastName"</span>] = @<span style="color: rgb(42, 161, 152);">"Hello"</span><span style="color: rgb(147, 161, 161);">;</span></code>
</pre>
<ul style="padding: 0px; text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">
<li>局限性</li>
</ul>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">字面量语法局限：除了字符串，所创建对象必须属于 Foundation 框架。</p>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">使用字面量语法创建的字符串、数组、字典对象都是不可变的（immutable），若想变成可变的，需复制一份，例如：</p>
<pre style="padding: 9.5px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 13px; color: rgb(101, 123, 131); border-radius: 4px; word-break: break-all; word-wrap: normal; white-space: pre; border: 1px solid rgba(0, 0, 0, 0.14902); overflow: auto; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: rgb(253, 246, 227);">
<code style="padding: 0px; font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12px; color: rgb(101, 123, 131); border-radius: 3px; border: none; white-space: pre; background-color: transparent;"><span style="color: rgb(38, 139, 210);">NSMutableArray</span> *<span style="color: rgb(133, 153, 0);">mutable</span> = [@[<span style="color: rgb(42, 161, 152);">@"cat"</span>, <span style="color: rgb(42, 161, 152);">@"dog"</span>, <span style="color: rgb(42, 161, 152);">@"monkey"</span>] <span style="color: rgb(133, 153, 0);">copy</span>];</code>
</pre>
<blockquote style="padding: 10px 15px; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(153, 153, 153); word-break: break-word; font-size: 15px; font-weight: 100; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: whitesmoke;">
<p style="font-size: 15px; font-weight: normal; text-align: justify; word-break: break-word;">要点：</p>
<ol style="padding: 0px; text-align: justify; word-break: break-word;">
<li>使用字面量语法来创建字符串、数值、数组、字典，与常规方法相比更加简明扼要。</li>
<li>通过取下标操作访问数组下标或字典中的键所对应的元素。</li>
<li>用字面量语法创建数组或字典时，值中有 nil 会抛出异常。</li>
</ol>
</blockquote>
<p style="text-align: justify; word-break: break-word; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-size: 16px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(252, 250, 242);">语法糖（syntactic sugar）：也称“糖衣语法”，计算机语言中与另一套语法等效但是开发者用起来却更加方便的语法。语法糖可令程序更易读，减少代码出错概率。</p>
<div style="padding: 10px 15px; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(153, 153, 153); word-break: break-word; font-size: 15px; font-weight: 100; color: rgb(47, 47, 47); font-family: 'lucida grande', 'lucida sans unicode', lucida, helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: whitesmoke;margin-left:40px;">
<div><br/></div>
<div style="font-size: 15px; font-weight: normal; text-align: justify; word-break: break-word;">
<div>主要来源：<a href="http://book.douban.com/subject/25829244/" target="_blank" style="color: rgb(64, 148, 199); text-decoration: none;">《Effective Objective-C 2.0》</a></div>
</div>
</div>
</div>
</body></html>